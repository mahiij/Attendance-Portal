<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Attendance Calendar</title>
    <link rel="stylesheet" href="attendance.css" />
</head>
<body style="background: linear-gradient(120deg, #f0f7ff 60%, #dbeafe 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center;">
    <div class="card attendance-calendar-card">
        <h2 style="text-align:center; color:#2563eb; margin-bottom:18px;">Section A Attendance</h2>
        <div class="card" style="margin-bottom:32px;">
          <h2>Attendance Calendar</h2>
          <div class="attendance-legend" style="margin-bottom:12px;">
            <span style="display:inline-block;width:18px;height:18px;background:#22c55e;border-radius:4px;margin-right:6px;vertical-align:middle;"></span> Present
            <span style="display:inline-block;width:18px;height:18px;background:#ef4444;border-radius:4px;margin:0 12px 0 18px;vertical-align:middle;"></span> Absent
            <span style="display:inline-block;width:18px;height:18px;background:#f59e42;border-radius:4px;margin:0 12px 0 18px;vertical-align:middle;"></span> Holiday
            <span style="display:inline-block;width:18px;height:18px;background:#a78bfa;border-radius:4px;margin:0 12px 0 18px;vertical-align:middle;"></span> Sunday
          </div>
          <div style="font-size:1.1em;font-weight:600;margin-bottom:8px;" id="calendarMonthYear"></div>
          <table class="attendance-calendar" style="width:100%;border-collapse:collapse;text-align:center;">
            <thead>
              <tr>
                <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
              </tr>
            </thead>
            <tbody id="calendarBody"></tbody>
          </table>
        </div>
        <div style="display:flex;justify-content:flex-end;align-items:center;margin-bottom:8px;">
            <button type="button" id="generateReportBtn" style="background:linear-gradient(90deg,#f59e42 60%,#fbbf24 100%);color:#fff;border:none;border-radius:6px;padding:10px 28px;font-size:1.1em;font-weight:700;cursor:pointer;box-shadow:0 2px 8px rgba(245,158,66,0.10);">Generate Report</button>
        </div>
        <div class="card-title">Attendance Marking</div>
        <div id="latestAttendanceSection" style="margin-bottom:24px; background:#f9fafb; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.06); padding:20px; display:none;">
          <h3 style="color:#2563eb;">Latest Attendance</h3>
          <div id="latestAttendanceContent">Loading...</div>
        </div>
        <form id="attendanceForm">
            <div style="margin-bottom:16px;display:flex;gap:16px;align-items:center;">
                <label for="dateInput"><strong>Date:</strong></label>
                <input type="date" id="dateInput" name="date" min="2025-07-01" max="2026-07-31" style="padding:6px 12px;font-size:1em;">
            </div>
            <div class="scrollable-attendance-table" style="margin-bottom:20px;">
              <table class="attendance-table" style="width:100%; border-collapse:collapse;">
                  <thead>
                      <tr>
                          <th style="padding:8px; border-bottom:1px solid #ccc;">Roll No</th>
                          <th style="padding:8px; border-bottom:1px solid #ccc;">Name</th>
                          <th style="padding:8px; border-bottom:1px solid #ccc;">Present</th>
                          <th style="padding:8px; border-bottom:1px solid #ccc;">Absent</th>
                      </tr>
                  </thead>
                  <tbody>
                      <!-- Student rows will be generated by JS -->
                  </tbody>
              </table>
            </div>
            <button type="submit" style="background:linear-gradient(90deg,#2563eb 60%,#60a5fa 100%);color:#fff;border:none;border-radius:6px;padding:10px 24px;font-size:1em;font-weight:600;cursor:pointer;">Submit Attendance</button>
            <button type="button" id="viewRecordsBtn" style="margin-left:12px;background:linear-gradient(90deg,#10b981 60%,#34d399 100%);color:#fff;border:none;border-radius:6px;padding:10px 24px;font-size:1em;font-weight:600;cursor:pointer;">View Records</button>
        </form>
        <div id="attendanceSummary" style="margin-top:24px;"></div>
    </div>
    <div id="attendanceRecords" style="display:none; margin-top:24px; background:#f9fafb; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.06); padding:20px;"></div>
    <div id="generateReportModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000; align-items:center; justify-content:center;">
      <div style="background:#fff; border-radius:12px; max-width:700px; width:95vw; margin:auto; margin-top:40px; padding:32px; box-shadow:0 8px 30px rgba(0,0,0,0.18); position:relative;">
        <button onclick="document.getElementById('generateReportModal').style.display='none'" style="position:absolute; top:12px; right:56px; background:none; border:none; font-size:1.5em; cursor:pointer;">&times;</button>
        <button id="printReportBtn" style="position:absolute; top:12px; right:16px; background:linear-gradient(90deg,#f59e42 60%,#fbbf24 100%);color:#fff;border:none;border-radius:6px;padding:6px 18px;font-size:1em;font-weight:600;cursor:pointer;">Print</button>
        <h2 id="reportTitle">Attendance Report</h2>
        <div id="generateReportContent">Loading...</div>
      </div>
    </div>
<script>
    const students = [
      { rollNo: "A001", name: "Aarav Sharma" },
      { rollNo: "A002", name: "Aanya Mehta" },
      { rollNo: "A003", name: "Rohan Verma" },
      { rollNo: "A004", name: "Sneha Reddy" },
      { rollNo: "A005", name: "Karan Kapoor" },
      { rollNo: "A006", name: "Priya Nair" },
      { rollNo: "A007", name: "Aditya Iyer" },
      { rollNo: "A008", name: "Anjali Desai" },
      { rollNo: "A009", name: "Vivek Choudhary" },
      { rollNo: "A010", name: "Meera Joshi" },
      { rollNo: "A011", name: "Aryan Malhotra" },
      { rollNo: "A012", name: "Isha Patil" },
      { rollNo: "A013", name: "Nikhil Saxena" },
      { rollNo: "A014", name: "Swathi Bansal" },
      { rollNo: "A015", name: "Rahul Rao" },
      { rollNo: "A016", name: "Kavya Bhatt" },
      { rollNo: "A017", name: "Manish Agarwal" },
      { rollNo: "A018", name: "Divya Shetty" },
      { rollNo: "A019", name: "Sagar Tripathi" },
      { rollNo: "A020", name: "Neha Dubey" },
      { rollNo: "A021", name: "Arjun Sinha" },
      { rollNo: "A022", name: "Pooja Yadav" },
      { rollNo: "A023", name: "Harsh Kulkarni" },
      { rollNo: "A024", name: "Shruti Jain" },
      { rollNo: "A025", name: "Siddharth Menon" },
      { rollNo: "A026", name: "Ritu Chatterjee" },
      { rollNo: "A027", name: "Yash Goel" },
      { rollNo: "A028", name: "Tanya Pillai" },
      { rollNo: "A029", name: "Suraj Bhatia" },
      { rollNo: "A030", name: "Bhavya Rathi" },
      { rollNo: "A031", name: "Om Salunkhe" },
      { rollNo: "A032", name: "Nivedita Basu" },
      { rollNo: "A033", name: "Raj Thakur" },
      { rollNo: "A034", name: "Keerthi Ranganathan" },
      { rollNo: "A035", name: "Tushar Khandelwal" },
      { rollNo: "A036", name: "Vaishnavi Dey" },
      { rollNo: "A037", name: "Varun Joshi" },
      { rollNo: "A038", name: "Rhea Anand" },
      { rollNo: "A039", name: "Sameer Khatri" },
      { rollNo: "A040", name: "Ananya Sengupta" },
      { rollNo: "A041", name: "Dhruv Ghosh" },
      { rollNo: "A042", name: "Jhanvi Nayak" },
      { rollNo: "A043", name: "Abhay Barot" },
      { rollNo: "A044", name: "Sanjana Mishra" },
      { rollNo: "A045", name: "Shreyas Pawar" },
      { rollNo: "A046", name: "Aishwarya Shukla" },
      { rollNo: "A047", name: "Vinay Solanki" },
      { rollNo: "A048", name: "Trisha Das" },
      { rollNo: "A049", name: "Kunal Bhargava" },
      { rollNo: "A050", name: "Srishti Lohia" },
      { rollNo: "A051", name: "Rohit Tiwari" },
      { rollNo: "A052", name: "Malvika Kohli" },
      { rollNo: "A053", name: "Tejas Sawant" },
      { rollNo: "A054", name: "Harini Iyer" },
      { rollNo: "A055", name: "Akash Jadhav" },
      { rollNo: "A056", name: "Ishita Vyas" },
      { rollNo: "A057", name: "Pranav Krishnan" },
      { rollNo: "A058", name: "Nikita Mahajan" },
      { rollNo: "A059", name: "Ayush Dugar" },
      { rollNo: "A060", name: "Sakshi Rawat" }
    ];
    const tbody = document.querySelector("tbody");
    students.forEach(student => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${student.rollNo}</td>
        <td>${student.name}</td>
        <td><input type="radio" name="attendance-${student.rollNo}" value="Present" required></td>
        <td><input type="radio" name="attendance-${student.rollNo}" value="Absent"></td>
      `;
      tbody.appendChild(row);
    });
    const dateInput = document.getElementById("dateInput");
    dateInput.value = new Date().toISOString().split("T")[0];
    document.getElementById("attendanceForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const date = dateInput.value;
      const attendanceData = {};
      let allMarked = true;
      students.forEach(student => {
        const value = document.querySelector(`input[name="attendance-${student.rollNo}"]:checked`);
        if (!value) {
          allMarked = false;
        } else {
          attendanceData[student.rollNo] = value.value;
        }
      });
      if (!allMarked) {
        alert("Mark attendance for all students.");
        return;
      }
      localStorage.setItem(`attendanceA_${date}`, JSON.stringify(attendanceData));
      // Store latest attendance for Section A (case-insensitive)
      localStorage.setItem("latestAttendanceA", JSON.stringify({
        present: students.filter(s => (attendanceData[s.rollNo] || '').toLowerCase() === "present").map(s => ({ roll: s.rollNo, name: s.name })),
        absent: students.filter(s => (attendanceData[s.rollNo] || '').toLowerCase() === "absent").map(s => ({ roll: s.rollNo, name: s.name }))
      }));
      alert("Attendance saved.");
    });
    document.getElementById("viewRecordsBtn").addEventListener("click", () => {
      let html = "<h3>Attendance Records</h3>";
      let count = 0;
      for (let key in localStorage) {
        if (key.startsWith("attendanceA_")) {
          const date = key.split("_")[1];
          const data = JSON.parse(localStorage.getItem(key));
          html += `<h4>${date}</h4><ul>`;
          for (let roll in data) {
            html += `<li>${roll}: ${data[roll]}</li>`;
          }
          html += "</ul>";
          count++;
        }
      }
      if (count === 0) html += "<p>No records yet.</p>";
      document.getElementById("attendanceRecords").innerHTML = html;
      document.getElementById("attendanceRecords").style.display = "block";
    });
    document.getElementById("generateReportBtn").addEventListener("click", () => {
      const content = document.getElementById("generateReportContent");
      let html = "<table><thead><tr><th>Roll No</th><th>Name</th><th>Present</th><th>Absent</th></tr></thead><tbody>";
      students.forEach(student => {
        let present = 0, absent = 0;
        for (let key in localStorage) {
          if (key.startsWith("attendanceA_")) {
            const record = JSON.parse(localStorage.getItem(key));
            if (record[student.rollNo] === "Present") present++;
            else if (record[student.rollNo] === "Absent") absent++;
          }
        }
        html += `<tr><td>${student.rollNo}</td><td>${student.name}</td><td>${present}</td><td>${absent}</td></tr>`;
      });
      html += "</tbody></table>";
      content.innerHTML = html;
      document.getElementById("generateReportModal").style.display = "flex";
    });
    document.getElementById("printReportBtn").addEventListener("click", () => {
      const content = document.getElementById("generateReportContent").innerHTML;
      const win = window.open("", "", "width=900,height=700");
      win.document.write("<html><head><title>Report</title></head><body>");
      win.document.write("<h2>Section A Attendance Report</h2>");
      win.document.write(content);
      win.document.write("</body></html>");
      win.document.close();
      win.print();
    });
    document.getElementById("closeReportModal").addEventListener("click", () => {
      document.getElementById("generateReportModal").style.display = "none";
    });
    // Demo attendance data for July 2025
    const attendanceData = {
      '2025-07-01': 'present', '2025-07-02': 'present', '2025-07-03': 'absent', '2025-07-04': 'present', '2025-07-05': 'holiday',
      '2025-07-06': 'present', '2025-07-07': 'present', '2025-07-08': 'absent', '2025-07-09': 'present', '2025-07-10': 'present',
      '2025-07-11': 'holiday', '2025-07-12': 'present', '2025-07-13': 'present', '2025-07-14': 'absent', '2025-07-15': 'present',
      '2025-07-16': 'present', '2025-07-17': 'present', '2025-07-18': 'holiday', '2025-07-19': 'present', '2025-07-20': 'absent',
      '2025-07-21': 'present', '2025-07-22': 'present', '2025-07-23': 'present', '2025-07-24': 'holiday', '2025-07-25': 'present',
      '2025-07-26': 'present', '2025-07-27': 'absent', '2025-07-28': 'present', '2025-07-29': 'present', '2025-07-30': 'holiday',
      '2025-07-31': 'present'
    };
    function renderCalendar() {
      const year = 2025, month = 6; // July 2025
      const daysInMonth = 31;
      const firstDay = new Date(year, month, 1).getDay();
      document.getElementById('calendarMonthYear').innerText = 'July 2025';
      let html = '';
      let day = 1;
      for (let week = 0; week < 6; week++) {
        html += '<tr>';
        for (let d = 0; d < 7; d++) {
          if ((week === 0 && d < firstDay) || day > daysInMonth) {
            html += '<td></td>';
          } else {
            const dateStr = `2025-07-${day.toString().padStart(2,'0')}`;
            let status = attendanceData[dateStr] || '';
            let color = '';
            if (d === 0) color = '#a78bfa'; // Sunday is purple
            else if (status === 'present') color = '#22c55e';
            else if (status === 'absent') color = '#ef4444';
            else if (status === 'holiday') color = '#f59e42';
            html += `<td style='background:${color};border-radius:6px;cursor:pointer;' onclick='showAttendanceDetail("${dateStr}","${status}")'>${day}</td>`;
            day++;
          }
        }
        html += '</tr>';
        if (day > daysInMonth) break;
      }
      document.getElementById('calendarBody').innerHTML = html;
    }
    function showAttendanceDetail(date, status) {
      let statusText = '';
      if (status === 'present') statusText = 'Present (Green)';
      else if (status === 'absent') statusText = 'Absent (Red)';
      else if (status === 'holiday') statusText = 'Holiday (Orange)';
      else if (new Date(date).getDay() === 0) statusText = 'Sunday (Purple)';
      else statusText = 'No record';
      alert(`Date: ${date}\nStatus: ${statusText}`);
    }
    function renderLatestAttendance() {
      const section = document.getElementById('latestAttendanceSection');
      const content = document.getElementById('latestAttendanceContent');
      const data = JSON.parse(localStorage.getItem('latestAttendanceA') || 'null');
      if (!data) {
        section.style.display = 'none';
        return;
      }
      section.style.display = 'block';
      let html = '';
      html += `<strong>Present:</strong> `;
      if (data.present.length === 0) html += 'None';
      else html += data.present.map(s => `${s.roll} - ${s.name}`).join(', ');
      html += '<br><strong>Absent:</strong> ';
      if (data.absent.length === 0) html += 'None';
      else html += data.absent.map(s => `${s.roll} - ${s.name}`).join(', ');
      content.innerHTML = html;
    }
    renderCalendar();
    // Call on page load
    renderLatestAttendance();
    // Update after attendance is marked
    document.getElementById('attendanceForm').addEventListener('submit', function() {
      setTimeout(renderLatestAttendance, 100);
    });
    </script>
</body>
</html>
